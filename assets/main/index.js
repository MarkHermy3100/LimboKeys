System.register("chunks:///_virtual/Shuffler.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,o,n,i,s,r,a,u,c,h,l,p,y,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,s=e.defineProperty},function(e){r=e.cclegacy,a=e._decorator,u=e.Node,c=e.AudioSource,h=e.AnimationClip,l=e.VideoPlayer,p=e.Vec3,y=e.Animation,f=e.Component}],execute:function(){var d,m,v,P,g,T,M,b,K,k,A,C,I,S,x,B;r._RF.push({},"ea9ab1ouYFNCa6oPF7X0Uv3","Shuffler",void 0);var E,w=a.ccclass,N=a.property;!function(e){e[e.TOP=240]="TOP",e[e.BOTTOM=-240]="BOTTOM",e[e.LEFT=-80]="LEFT",e[e.RIGHT=80]="RIGHT",e[e.DISTANCE=160]="DISTANCE"}(E||(E={}));e("Shuffler",(d=w("Shuffler"),m=N(u),v=N(c),P=N(u),g=N([u]),T=N([h]),M=N(l),d((k=t((K=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(i(t),"canvas",k,i(t)),n(i(t),"music",A,i(t)),n(i(t),"flash",C,i(t)),n(i(t),"speed",I,i(t)),n(i(t),"keys",S,i(t)),n(i(t),"keyAnim",x,i(t)),n(i(t),"ending",B,i(t)),s(i(t),"patterns",[[2,4,1,3,6,8,5,7],[2,4,1,3,7,5,8,6],[3,1,4,2,6,8,5,7],[3,1,4,2,7,5,8,6],[2,4,1,6,3,8,5,7],[3,1,5,2,7,4,8,6],[2,1,4,3,6,5,8,7],[4,3,2,1,8,7,6,5],[3,4,5,6,7,8,2,1],[8,7,1,2,3,4,5,6],[1,3,2,5,4,7,8,6],[1,3,2,5,4,8,6,7],[4,2,6,1,7,3,8,5],[4,2,6,1,8,3,5,7],[2,4,6,1,8,3,7,5],[4,1,6,2,8,3,7,5],[2,3,1,5,4,7,6,8],[3,1,2,5,4,7,6,8]]),s(i(t),"patternHistory",[-1]),s(i(t),"specialPatterns",[[5,6,7,8,1,2,3,4],[8,7,6,5,4,3,2,1]]),s(i(t),"delay",7/6),s(i(t),"chosen",Math.floor(8*Math.random())),s(i(t),"activate",0),s(i(t),"input",!1),t}o(t,e);var r=t.prototype;return r.isReversePattern=function(e,t){return-1==e||(e<=3?!(t>3)&&t!=e:e<=5?!(t<4||t>5)&&t!=e:e<=7?t==e:e<=9?!(t<8||t>9)&&t!=e:!(t<10)&&(e%2==0&&t==e+1))},r.shuffle=function(e){for(var t=e.length;t>=1;t--){var o=Math.floor(Math.random()*t);e.push(e.splice(o,1)[0])}return e},r.choosePattern=function(){for(var e=-1;this.isReversePattern(e,this.patternHistory[this.patternHistory.length-1]);)switch(Math.floor(6*Math.random())){case 0:e=Math.floor(4*Math.random());break;case 1:e=4+Math.floor(2*Math.random());break;case 2:e=6;break;case 3:e=7;break;case 4:e=8+Math.floor(2*Math.random());break;case 5:e=10+Math.floor(8*Math.random())}return this.patternHistory.push(e),e},r.onLoad=function(){var e=this;this.music.play();var t=this.shuffle([1,2,3,4,5,6,7,8]);this.canvas.on(u.EventType.TOUCH_START,(function(o){if(e.input)for(var n=function(n){var i;Math.abs(o.getUILocation().x-480-e.keys[n].position.x)<61&&Math.abs(o.getUILocation().y-320-e.keys[n].position.y)<42&&(e.flash.active=!0,null===(i=e.flash.getComponent(y))||void 0===i||i.play("color"+t[n]+"_bg"),e.input=!1,e.schedule((function(){e.music.pause(),n==e.chosen?e.ending.remoteURL="video/right_key.mp4":e.ending.remoteURL="video/wrong_key.mp4",e.ending.play()}),0,0,.6))},i=0;i<8;i++)n(i)}));for(var o=1;o<=5;o++)this.schedule((function(){for(var t=e.choosePattern(),o=1;o<=8;o++)e.moveKey(e.getKeyByPos(o),o,e.patterns[t][o-1],e.speed,0,0)}),0,0,this.delay+1.5*o/this.speed);this.schedule((function(){for(var t=Math.floor(2*Math.random()),o=1;o<=8;o++)o<=4?e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[0][o-1],e.speed/2.75,t,0):e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[0][o-1],e.speed/2.75,t-1,0)}),0,0,this.delay+1.5/this.speed*6);for(var n=7;n<=9;n++)this.schedule((function(){for(var t=e.choosePattern(),o=1;o<=8;o++)e.moveKey(e.getKeyByPos(o),o,e.patterns[t][o-1],e.speed,0,0)}),0,0,this.delay+1.5*n/this.speed+1.5/this.speed);this.schedule((function(){for(var t=2*Math.floor(2*Math.random())-1,o=1;o<=8;o++)o<=2?e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[1][o-1],e.speed/2.75,t>0?t:0,t):o<=6?e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[1][o-1],e.speed/2.75,t,t):e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[1][o-1],e.speed/2.75,t<0?t:0,t)}),0,0,this.delay+1.5/this.speed*11);for(var i=11;i<=15;i++)this.schedule((function(){for(var t=e.choosePattern(),o=1;o<=8;o++)e.moveKey(e.getKeyByPos(o),o,e.patterns[t][o-1],e.speed,0,0)}),0,0,this.delay+1.5*i/this.speed+1.5/this.speed*2);this.speed*=1.2;for(var s=16;s<=18;s++)this.schedule((function(){for(var t=e.choosePattern(),o=1;o<=8;o++)e.moveKey(e.getKeyByPos(o),o,e.patterns[t][o-1],e.speed,0,0)}),0,0,this.delay+1.5*s/this.speed+1.5/this.speed*18*1.2-1.5/this.speed*16);this.schedule((function(){for(var t=2*Math.floor(2*Math.random())-1,o=1;o<=8;o++)o<=2?e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[1][o-1],e.speed/2.75,t>0?t:0,t):o<=6?e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[1][o-1],e.speed/2.75,t,t):e.moveKey(e.getKeyByPos(o),o,e.specialPatterns[1][o-1],e.speed/2.75,t<0?t:0,t)}),0,0,this.delay+1.5/this.speed*18*1.2+1.5/this.speed*3);for(var r=20;r<=26;r++)this.schedule((function(){for(var t=e.choosePattern(),o=1;o<=8;o++)e.moveKey(e.getKeyByPos(o),o,e.patterns[t][o-1],e.speed,0,0)}),0,0,this.delay+1.5*r/this.speed+1.5/this.speed*18*1.2-1.5/this.speed*15);this.schedule((function(){for(var o=function(o){e.schedule((function(){var n,i;e.rotateAnim(e.keys[o],.5),e.keys[o].addComponent(y),null===(n=e.keys[o].getComponent(y))||void 0===n||n.createState(e.keyAnim[t[o]]),null===(i=e.keys[o].getComponent(y))||void 0===i||i.play(e.keyAnim[t[o]].name)}),0,0,o/15)},n=0;n<8;n++)o(n)}),0,0,this.delay+1.5/this.speed*18*1.2+1.5/this.speed*12),this.schedule((function(){e.input=!0}),0,0,this.delay+1.5/this.speed*18*1.2+1.5/this.speed*16)},r.numToVec=function(e){return new p(E.RIGHT-e%2*E.DISTANCE,E.TOP-Math.floor((e-1)/2)*E.DISTANCE,0)},r.vecToNum=function(e){return(E.TOP-e.y)/E.DISTANCE*2-(E.RIGHT-e.x)/E.DISTANCE+2},r.getKeyByPos=function(e){for(var t=0;t<8;t++)if(this.vecToNum(this.keys[t].position)==e)return this.keys[t];return this.keys[-1]},r.moveKey=function(e,t,o,n,i,s){var r=this;0==i?function(){for(var i=r.numToVec(o).x-r.numToVec(t).x,s=r.numToVec(o).y-r.numToVec(t).y,a=0;a<E.DISTANCE;a++)r.schedule((function(){e.setPosition(e.position.x+i/E.DISTANCE,e.position.y+s/E.DISTANCE)}),0,0,a/E.DISTANCE/n)}():function(){var s=new p((r.numToVec(o).x+r.numToVec(t).x)/2,(r.numToVec(o).y+r.numToVec(t).y)/2),a=r.numToVec(t),u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),c=Math.acos((a.x-s.x)/Math.sqrt(u));a.y<s.y&&(c=2*Math.PI-c);for(var h=1;h<=180;h++)r.schedule((function(){c+=i*Math.PI/180,e.setPosition(s.x+Math.sqrt(u)*Math.cos(c),s.y+Math.sqrt(u)*Math.sin(c))}),0,0,h/180/n);r.schedule((function(){e.setPosition(Math.round(e.position.x),Math.round(e.position.y))}),0,0,1/n+1/360)}(),0!=s&&function(){for(var t=e.rotation.z,o=function(o){r.schedule((function(){e.setRotationFromEuler(0,0,180*t+o*s)}),0,0,o/180/n)},i=1;i<=180;i++)o(i)}()},r.rotateAnim=function(e,t){for(var o=this,n=function(n){o.schedule((function(){e.setRotationFromEuler(0,0,360*Math.pow(n/200-1,4))}),0,0,n/200*t)},i=1;i<=200;i++)n(i);this.schedule((function(){e.setRotationFromEuler(0,0,0)}),0,0,t+1/360)},r.update=function(e){var t,o;0==this.activate&&(this.activate++,this.keys[this.chosen].addComponent(y),null===(t=this.keys[this.chosen].getComponent(y))||void 0===t||t.createState(this.keyAnim[0]),null===(o=this.keys[this.chosen].getComponent(y))||void 0===o||o.play("glow_green"))},t}(f)).prototype,"canvas",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(K.prototype,"music",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(K.prototype,"flash",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(K.prototype,"speed",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),S=t(K.prototype,"keys",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=t(K.prototype,"keyAnim",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=t(K.prototype,"ending",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=K))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Shuffler.ts"],(function(){"use strict";return{setters:[null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});